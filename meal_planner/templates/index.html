<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Meal Planner</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style_index.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
</head>
<body>
  <header>
    <h1>Meal Planner</h1>
    <p>Benvenuto, utente ID: {{ user_id }}!</p>
    <a href="{{ url_for('logout') }}">Logout</a>
  </header>

  <main>
    <section class="piatti">
      <h2>Piatti disponibili</h2>
      <button id="open-create-piatto-modal">Crea nuovo piatto</button>
      <div id="create-piatto-modal" style="display:none;">
        <form id="create-piatto-form">
          <h3>Crea nuovo piatto</h3>
          <label>Nome: <input type="text" name="nome" required></label><br>
          <label>Descrizione: <input type="text" name="descrizione"></label><br>
          <div id="ingredienti-list"></div>
          <label>Vuoi rendere visibile il tuo piatto agli altri utenti?</label><br>
              <label><input type="radio" name="validato_piatto" value="1" required> Sì</label>
              <label><input type="radio" name="validato_piatto" value="0" required> No</label>
          <button type="submit">Salva</button>
          <button type="button" id="close-create-piatto-modal">Annulla</button>
        </form>
        <button type="button" id="open-add-ingrediente-modal">Aggiungi ingrediente</button>
          <div id="add-ingrediente-modal" style="display:none;">
            <form id="add-ingrediente-form">
              <h4>Nuovo ingrediente</h4>
              <label>Nome: <input type="text" name="nome" required></label><br>
              <label>Unità di misura: <input type="text" name="unita_misura" required></label><br>
              <label>Proteine: <input type="number" name="proteine" step="0.01" required></label><br>
              <label>Carboidrati: <input type="number" name="carboidrati" step="0.01" required></label><br>
              <label>Calorie: <input type="number" name="calorie" step="0.01" required></label><br>
              <label>Vuoi rendere visibile il tuo ingrediente agli altri utenti?</label><br>
              <label><input type="radio" name="validato_ingrediente" value="1" required> Sì</label>
              <label><input type="radio" name="validato_ingrediente" value="0" required> No</label>
              <button type="submit">Salva ingrediente</button>
              <button type="button" id="close-add-ingrediente-modal">Annulla</button>
            </form>
          </div>
      </div>
      <ul id="piatti-list" aria-label="Lista piatti disponibili">
        {% for piatto in piatti %}
          <li draggable="true" data-id="{{ piatto[0] }}" tabindex="0">
          {{ piatto[1] }}
          
          </li>
        {% endfor %}
      </ul>
      
    </section>

    <section class="planner">
      <h2>Il tuo planner settimanale</h2>
      <div class = "table-responsive">
      <table id="calendar" aria-label="Calendario planner settimanale">
          <thead>
            <tr>
              <th>Pasto / Giorno</th>
              {% for giorno in ['Lunedì','Martedì','Mercoledì','Giovedì','Venerdì','Sabato','Domenica'] %}
                <th class="giorno-header" data-giorno="{{ giorno }}">{{ giorno }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for pasto in ['colazione','pranzo','merenda','cena'] %}
              <tr>
                <th>{{ pasto|capitalize }}</th>
                {% for giorno in ['Lunedì','Martedì','Mercoledì','Giovedì','Venerdì','Sabato','Domenica'] %}
                  <td class="cell" data-giorno="{{ giorno }}" data-pasto="{{ pasto }}">
                    <!-- Qui JS inserirà i piatti -->
                  </td>
                {% endfor %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
        <div id="stats-container" class="stats">
        <h3>Statistiche nutrizionali</h3>
        <div>
          
          
          <button id="stats-day-btn">Mostra statistiche giorno</button>
        </div>
        <div>
         
          
          
          
          <button id="stats-week-btn">Mostra statistiche settimana</button>
        </div>
        <div id="stats-result"></div>
      </div>  
      </div> 
    </section>
  </main>

  <div id="planner-data"
     data-planner='{{ planner | tojson | safe }}'
     data-user-id='{{ user_id | tojson | safe }}'
     style="display:none"></div>

  <script src="{{ url_for('static', filename='js/planner.js') }}"></script>
  <script src="{{ url_for('static', filename='js/gestorenewpiatti.js') }}"></script>
  <script src="{{ url_for('static', filename='js/gestore_stats.js') }}"></script>
</body>
</html>
